import{r as m,j as o}from"./jsx-runtime-BGxL3LVy.js";import{c as b}from"./utils-mMyIM9tf.js";import{T as y,a as P,P as h}from"./react-icons.esm-D-bY5_Bc.js";import{O as g}from"./index-C7wa7IgK.js";import{S as j}from"./skeleton-jaTN8ZDn.js";import{u as C,g as I,a as w}from"./useProductState-Dtp7AN7_.js";import{a as p}from"./index-DUyAALTD.js";import{u as S}from"./index-CXeFjl5i.js";import{P as B,a as D,b as L}from"./ProductImage-D9_CEa6B.js";import{L as N}from"./components-C7TJjWXG.js";import{u as _}from"./useWebsite-B2NA3eOh.js";import{i as x}from"./env-D6s-xqZ4.js";import{a as k}from"./index-CohxQZEM.js";function A(l){const{product:s}=l,a=S(),t=C(),u=p(r=>r.preferencesLoading),e=p(r=>{var n;return(n=r.cart)==null?void 0:n.items})||[],d=m.useMemo(()=>e.filter(r=>r.productId===s._id).map(r=>r.amount).reduce((r,n)=>r+n,0),[e]),i=m.useMemo(()=>e.find(r=>r.productId===s._id),[e]),c=m.useMemo(()=>{var n;const r=I(s);return i?{cartItemId:i._id,productId:i.productId,modifiers:((n=i.modifiers)==null?void 0:n.map(f=>({modifierId:f.modifierId,optionsIds:f.optionsIds})))||[],comment:null,amount:i.amount}:r},[i,d]);return u?o.jsx(j,{className:"bg-primary absolute bottom-2.5 right-2.5 h-7 w-7 rounded-full"}):l.disabled?null:d?o.jsxs("div",{className:"webv3_addProductCardButtonGroup flex bg-primary text-primary-foreground rounded-full items-center justify-center absolute bottom-2.5 right-2.5",children:[o.jsx(g,{"aria-label":"Quitar uno del carrito",className:"webv3_addProductCardButtonGroupItem Buttonh-7 px-2",onClick:async()=>{t({...c,amount:c.amount-1})},children:c.amount===1?o.jsx(y,{}):o.jsx(P,{})}),o.jsx("div",{children:d}),o.jsx(g,{className:"webv3_addProductCardButtonGroupItem h-7 px-2","aria-label":"Agregar otro al carrito",onClick:async()=>{t({...c,amount:c.amount+1})},children:o.jsx(h,{})})]}):o.jsx(g,{"aria-label":"Agregar al carrito",className:b("webv3_addProductCardButton absolute bottom-2.5 right-2.5 h-7 w-7 rounded-full flex-1 bg-primary text-primary-foreground flex items-center justify-center"),onClick:async()=>{if(w(s,c).missingModifier){a(s.path,{preventScrollReset:!0});return}try{await t(c)}catch(n){console.log("error",n)}},children:o.jsx(h,{})})}const U=m.memo(function(s){var e;const{product:a,design:t}=s,u=a.isOutOfStock||!((e=a.availabilityAt)!=null&&e.available);return o.jsxs("div",{className:"relative product-card",children:[o.jsxs(N,{prefetch:"viewport",preventScrollReset:!0,to:s.basePath?a.path.replace("/pedir",s.basePath):a.path,className:b("rounded-lg flex border bg-card text-card-foreground justify-between",{"opacity-60":u,"h-40 items-stretch flex-row":t.isHorizontal&&!t.isHorizontallyReversed,"h-40 items-stretch flex-row-reverse":t.isHorizontallyReversed,"flex-col h-72 items-center":t.isVertical&&!t.isCompact,"flex-col h-[278px] items-center":t.isVertical&&t.isCompact}),children:[o.jsx(B,{product:a,design:t}),o.jsx(D,{product:a,design:t}),o.jsx(L,{product:a,design:t})]}),!s.readOnly&&o.jsx(A,{design:t,product:a,disabled:u})]})});function J(l){const s=_(),a=k(),t=p(e=>e.preferencesLoading),u=p(e=>{var d,i;return!!((i=(d=e.preferences)==null?void 0:d.store)!=null&&i._id)});return m.useMemo(()=>{let e=s.designConfiguration.productCardDesign;(!e||e==="default")&&(e="row-inverse-fast"),l&&(e=l);const d=e.includes("-fast"),i=e.includes("row"),c=e.includes("row-inverse"),r=e.includes("vertical"),n=e.includes("vertical-compact"),f=i?"horizontal":"vertical",v=x||!s.dontShowPricesUntilStoreSelected||x||t?!1:!u;return{cardType:e,hasFastAdd:d,isHorizontal:i,isHorizontallyReversed:c,isVertical:r,isCompact:n,isFullWidth:a==="fullWidth"||a==="categories",cardOrientation:f,countryCode:s.countryCode,shouldHidePrices:v,hideProductsDiscountBadge:s.designConfiguration.hideProductsDiscountBadge,orderLayout:a}},[u])}export{U as P,J as u};
