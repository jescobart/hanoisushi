import{c as y}from"./createLucideIcon-gj9TAl09.js";import{R as f,j as e,r as w}from"./jsx-runtime-BGxL3LVy.js";import{R as $,I as E,H as Q,T as S,C as B}from"./index-CCl8e3Fs.js";import{c as L}from"./index-7UdPD0wL.js";import{c as d}from"./utils-mMyIM9tf.js";import{g as A,h as U,c as H,d as W,e as T,f as G,i as X}from"./popover-LlYgTbu8.js";import{B as v}from"./index-cWEE_j1p.js";import{S as J}from"./index-B7S20zKg.js";import{b as _}from"./Context-BxTGfssI.js";import{F as K}from"./index-DhFb9xq3.js";import{a as x}from"./index-DUyAALTD.js";import{u as Y}from"./index-CXeFjl5i.js";import{a as Z}from"./useWebsite-B2NA3eOh.js";import{u as ee,a as re}from"./useDebouncedValue-HavTh-j-.js";import{u as se}from"./TimeButton-C3VNtdr7.js";import{L as ae}from"./components-C7TJjWXG.js";import{X as ne}from"./index-DQcw9fEh.js";import{h as oe}from"./react-icons.esm-D-bY5_Bc.js";import{C as te}from"./ClientOnly-C9d8okrb.js";import{S as F}from"./skeleton-jaTN8ZDn.js";import{u as le}from"./useTranslation-B_PywvDf.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ce=y("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ie=y("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ve=y("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const de=y("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ue=y("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),O=L("group hover:before:opacity-100 before:absolute before:rounded-lg before:left-0 px-2 before:w-full before:opacity-0 before:bg-accent/70 before:h-[2rem] before:-z-10"),M=L("before:opacity-100 before:bg-accent/70 text-accent-foreground"),fe=f.forwardRef(({data:r,initialSelectedItemId:s,onSelectChange:n,expandAll:a,defaultLeafIcon:o,defaultNodeIcon:t,className:l,...c},i)=>{const[p,b]=f.useState(s),u=f.useCallback(h=>{b(h==null?void 0:h.id),n&&n(h)},[n]),D=f.useMemo(()=>{if(!s)return[];const h=[];function N(m,g){var C;if(Array.isArray(m))for(let j=0;j<m.length;j++){if(h.push((C=m[j])==null?void 0:C.id),m[j]&&N(m[j],g)&&!a)return!0;a||h.pop()}else{if(!a&&m.id===g)return!0;if(m.children)return N(m.children,g)}}return N(r,s),h},[r,a,s]);return e.jsx("div",{className:d("overflow-hidden relative",l),children:e.jsx(k,{data:r,ref:i,selectedItemId:p,handleSelectChange:u,expandedItemIds:D,defaultLeafIcon:o,defaultNodeIcon:t,...c})})});fe.displayName="TreeView";const k=f.forwardRef(({className:r,data:s,selectedItemId:n,handleSelectChange:a,expandedItemIds:o,defaultNodeIcon:t,defaultLeafIcon:l,...c},i)=>(Array.isArray(s)||(s=[s]),e.jsx("div",{ref:i,role:"tree",className:r,...c,children:e.jsx("ul",{children:s.map(p=>e.jsx("li",{children:p.children?e.jsx(pe,{item:p,selectedItemId:n,expandedItemIds:o,handleSelectChange:a,defaultNodeIcon:t,defaultLeafIcon:l}):e.jsx(z,{item:p,selectedItemId:n,handleSelectChange:a,defaultLeafIcon:l})},p.id))})})));k.displayName="TreeItem";const pe=({item:r,handleSelectChange:s,expandedItemIds:n,selectedItemId:a,defaultNodeIcon:o,defaultLeafIcon:t})=>{const[l,c]=f.useState(n.includes(r.id)?[r.id]:[]);return e.jsx($,{type:"multiple",value:l,onValueChange:i=>c(i),children:e.jsxs(E,{value:r.id,children:[e.jsxs(P,{className:d(O(),a===r.id&&M()),onClick:()=>{var i;s(r),(i=r.onClick)==null||i.call(r)},children:[e.jsx(I,{item:r,isSelected:a===r.id,isOpen:l.includes(r.id),default:o}),e.jsx("span",{className:"text-sm truncate",children:r.name}),e.jsx(q,{isSelected:a===r.id,children:r.actions})]}),e.jsx(V,{className:"ml-4 pl-1 border-l",children:e.jsx(k,{data:r.children?r.children:r,selectedItemId:a,handleSelectChange:s,expandedItemIds:n,defaultLeafIcon:t,defaultNodeIcon:o})})]})})},z=f.forwardRef(({className:r,item:s,selectedItemId:n,handleSelectChange:a,defaultLeafIcon:o,...t},l)=>e.jsxs("div",{ref:l,className:d("ml-5 flex text-left items-center py-2 cursor-pointer before:right-1",O(),r,n===s.id&&M()),onClick:()=>{var c;a(s),(c=s.onClick)==null||c.call(s)},...t,children:[e.jsx(I,{item:s,isSelected:n===s.id,default:o}),e.jsx("span",{className:"flex-grow text-sm truncate",children:s.name}),e.jsx(q,{isSelected:n===s.id,children:s.actions})]}));z.displayName="TreeLeaf";const P=f.forwardRef(({className:r,children:s,...n},a)=>e.jsx(Q,{children:e.jsxs(S,{ref:a,className:d("flex flex-1 w-full items-center py-2 transition-all first:[&[data-state=open]>svg]:rotate-90",r),...n,children:[e.jsx(ce,{className:"h-4 w-4 shrink-0 transition-transform duration-200 text-accent-foreground/50 mr-1"}),s]})}));P.displayName=S.displayName;const V=f.forwardRef(({className:r,children:s,...n},a)=>e.jsx(B,{ref:a,className:d("overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",r),...n,children:e.jsx("div",{className:"pb-1 pt-0",children:s})}));V.displayName=B.displayName;const I=({item:r,isOpen:s,isSelected:n,default:a})=>{let o=a;return n&&r.selectedIcon?o=r.selectedIcon:s&&r.openIcon?o=r.openIcon:r.icon&&(o=r.icon),o?e.jsx(o,{className:"h-4 w-4 shrink-0 mr-2"}):e.jsx(e.Fragment,{})},q=({children:r,isSelected:s})=>e.jsx("div",{className:d(s?"block":"hidden","absolute right-3 group-hover:block"),children:r});function he(r){const{product:s}=r,n=Y(),a=x(t=>{var l;return(l=t.cart)==null?void 0:l.items})||[],o=w.useMemo(()=>a.filter(t=>t.productId===s._id).map(t=>t.amount).reduce((t,l)=>t+l,0),[a]);return e.jsx(A,{className:"!py-0",onSelect:()=>{n(s.path)},children:e.jsxs("div",{className:"flex items-center space-x-2 py-2 relative w-full",children:[s.thumbnailURL&&e.jsx("img",{src:s.thumbnailURL,className:"h-10 w-10 object-cover border rounded",alt:s.name}),e.jsx("div",{className:"flex-1 line-clamp-2 font-bold",children:s.name}),e.jsx("div",{className:"text-muted-foreground",children:e.jsx(K,{number:s.price})}),o?e.jsx("div",{className:"absolute -left-2 !m-0 top-1 bg-primary text-center text-primary-foreground rounded-full min-w-[18px] px-1 h-[18px]",children:o}):null]})},s._id)}function me(r){const[s,n]=ee(r,100),a=x(c=>{var i;return((i=c==null?void 0:c.preferences)==null?void 0:i.menuId)||"default"}),o=Z(),t=re(`/v1/websites/${o}/menus/${a}/autocomplete?query=${encodeURIComponent(s)}`,{skip:!r});return{results:se(t.data),loading:r&&(t.loading||n)}}function Ie(r){var b;const{variant:s}=r,n=_(u=>u==null?void 0:u.searchFilter),a=_(u=>u==null?void 0:u.setSearchFilter),[o,t]=w.useState(""),[l,c]=w.useState(!1),{results:i,loading:p}=me(o);return e.jsxs(e.Fragment,{children:[n?e.jsxs(e.Fragment,{children:[e.jsx(v,{"aria-label":"Buscar",variant:"opacity",size:s==="navbar"?"icon":"auto",type:"button",children:e.jsx(ae,{to:"/pedir",children:e.jsx(ne,{className:d({"h-6 w-6":s==="navbar","h-5 w-5":s!=="navbar"})})})}),s==="navbar"?null:e.jsx(v,{"aria-label":"Buscar",variant:"opacity",size:"auto",type:"button",className:"w-full text-left justify-start h-12 flex",onClick:()=>{c(!0)},children:e.jsx("div",{className:"",children:n})})]}):e.jsxs(v,{"aria-label":"Buscar",variant:"opacity",size:s==="navbar"?"icon":"auto",type:"button",className:d({"w-full justify-start h-12 flex":s==="full"}),onClick:()=>{c(!0)},children:[e.jsx(de,{className:d({"h-6 w-6":s==="navbar","h-5 w-5":s!=="navbar"})}),s==="full"?e.jsx("div",{className:"text-muted-foreground ml-2",children:"Buscar productos"}):null]}),e.jsxs(U,{open:l,onOpenChange:c,commandProps:{shouldFilter:!1,loop:!0},children:[e.jsx(H,{placeholder:"Buscar productos...",value:o,onValueChange:t}),e.jsxs(W,{children:[o?e.jsx(T,{children:"No se encontraron resultados."}):e.jsx(T,{children:"¿Qué estás buscando?"}),o&&e.jsx(A,{onSelect:()=>{a(o),c(!1)},children:e.jsxs("div",{className:"px-2",children:['Buscar "',o,'"']})}),(b=i==null?void 0:i.products)!=null&&b.length?e.jsx(G,{heading:"Productos",children:i.products.map(u=>e.jsx(he,{product:u},u._id))}):null,p&&e.jsx(X,{children:e.jsx("div",{className:"flex justify-center w-full py-2",children:e.jsx(J,{})})})]})]})]})}const R=18;function xe(){const r=x(t=>t.preferences),s=x(t=>t.preferencesLoading),{t:n}=le();if(s||!r)return null;const a=d("truncate");if(r.isOutOfBounds===null)return e.jsx(F,{className:"w-[150px] h-[14px] rounded-full"});if(r.isOutOfBounds)return e.jsxs("div",{className:"flex items-center text",children:[e.jsx(ue,{className:"w-5 h-5 mr-2 text-orange-200"}),e.jsx("div",{children:n("lazy_legal_cat_coax")})]});if(r.deliveryType==="delivery"){if(r.address){const t=[r.address.streetAddress,r.address.extendedAddress].filter(Boolean).join(", "),l=t.length>R?`${t.slice(0,R)}...`:t;return e.jsx("div",{className:a,children:l})}return e.jsxs("div",{className:d(a,"flex items-center"),children:[e.jsx(ie,{className:"w-4 h-4 mr-2"}),e.jsx("span",{children:n("only_proud_stork_loop")})]})}if(!r.store)return e.jsx("div",{className:a,children:n("home_full_grizzly_slide")});if(r.deliveryType==="go")return e.jsx("div",{className:a,children:n("flaky_each_ox_drip",{storeName:r.store.name})});const o=r.tableName?n("upper_smug_whale_sprout",{tableName:r.tableName}):n("keen_lucky_tuna_lift");return e.jsxs("div",{className:a,children:[r.store.name,", ",o]})}function qe(r){const s=x(a=>a.setChoosePlaceOpen),n=x(a=>a.preferencesLoading);return e.jsx(v,{full:r.variant==="cart",variant:r.variant==="cart"?"secondary":"outline",onClick:()=>{s(!0)},className:d({"max-w-[60dvw]":r.variant==="bar"}),children:e.jsxs("div",{className:d("flex justify-between items-center space-x-2 w-full"),children:[e.jsx(te,{forceFallback:n,fallback:e.jsx(F,{className:"w-[150px] h-[14px] rounded-full"}),children:e.jsx(xe,{})}),e.jsx(oe,{className:"h-5 w-5"})]})})}export{ie as M,Ie as N,qe as O,fe as T,Ve as a,ue as b};
