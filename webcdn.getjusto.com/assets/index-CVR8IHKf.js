import{j as e,r as b}from"./jsx-runtime-BGxL3LVy.js";import{u as X}from"./hooks-BXGtQO4o.js";import{a as Y}from"./index-DUyAALTD.js";import{B as M}from"./index-cWEE_j1p.js";import{O}from"./index-C7wa7IgK.js";import{c as P}from"./clsx-B-dksMZM.js";import{I as Z}from"./index-BFQuIHSE.js";import{N as ee}from"./index-D0IKzcAI.js";import{c as $}from"./createLucideIcon-gj9TAl09.js";import{a as te,b as S}from"./Context-BarPatdd.js";import{F as A}from"./index-BALO_H0H.js";import{s as se}from"./sleep-BvINh1mj.js";import{b as ie,c as ne,d as re,u as ae,e as oe}from"./useProductState-Dtp7AN7_.js";import{u as y}from"./useTranslation-B_PywvDf.js";import{u as ce}from"./index-CXeFjl5i.js";import{q as de}from"./index-Dg1ijqza.js";import{l as N}from"./index-Dpcw64aj.js";import{O as le}from"./index-BbH7TfgA.js";import{T as me}from"./index-DCntFPjS.js";import{M as _,d as E}from"./index-DYTzf-DC.js";import{u as V}from"./useWebsite-B2NA3eOh.js";import{c as v}from"./utils-mMyIM9tf.js";import{B as I}from"./badge-DAjfRXK0.js";import{g as q}from"./getImageSrcSet-Duns6C57.js";import{C as ue}from"./index-BJo8DL8B.js";import{u as fe}from"./uniqueId-DlOYuaFD.js";import{u as k,I as xe}from"./index-CohxQZEM.js";import{L as T}from"./index-BJLV6hUK.js";import{u as he}from"./isJustoApp-DujzpsFs.js";import{B as je,a as pe,b as C,c as L,d as D,e as ge}from"./breadcrumb-CmxDwxpD.js";import{C as ve,a as be,b as ye,I as Ne,M as _e}from"./carousel-WfFnvB-S.js";import{F as Ie}from"./index-DhFb9xq3.js";import{L as B}from"./components-C7TJjWXG.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z=$("CircleMinus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=$("CirclePlus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);function Ce(t){const{value:s,onChange:i,hideTextInput:n}=t,r=s||0,a=t.roundToDecimals??0,o=t.min||0,d=t.max,f=d?r<d:!0,x=r>o;return e.jsx(Z,{...t,children:e.jsxs("div",{className:P("cv-text-text flex items-center space-x-1 ",t.containerClassName),children:[e.jsx(O,{className:x?"cursor-pointer":"cv-text-bg-2 text-muted-foreground",onClick:x?()=>i(r-1):null,children:e.jsx(z,{className:"h-5 w-5"})}),n?null:e.jsx(ee,{inputMode:"decimal",className:P(t.inputClassName,"text-center cv-bg-bg-1 cv-border-bg-2"),value:r,onChange:i,maxDecimals:a}),e.jsx(O,{className:f?"cursor-pointer":"cv-text-bg-2 text-muted-foreground",onClick:f?()=>i(r+1):null,children:e.jsx(U,{className:"h-5 w-5"})})]})})}function Oe(t){const s=k(n=>(n==null?void 0:n.outOfStockItemsMap)||{}),i=k(n=>n==null?void 0:n.menuId);return b.useMemo(()=>{var n;return t?{...t,isOutOfStock:s[t==null?void 0:t._id]===0,modifiers:(n=t.modifiers)==null?void 0:n.map(r=>{var a;return{...r,options:(a=r.options)==null?void 0:a.map(o=>({...o,isOutOfStock:s[o._id]===0}))}})}:null},[t,s,i])}function ke(t,s){const i=Oe(t),{state:n,setState:r}=ie(i,s),a=ne(i.modifiers,n),o=re(i,n);return{cartItem:s,product:i,resume:o,filteredModifiers:a,state:n,setState:r}}const Q=b.createContext(null);function w(){return b.useContext(Q)}function Me(){const{t}=y();return e.jsx(M,{disabled:!0,children:t("best_sad_yak_offer")})}function Se(){const{t}=y();return e.jsx(M,{disabled:!0,children:t("soft_tense_polecat_work")})}function Ae(){var p;const{product:t,state:s,setState:i,resume:n,cartItem:r}=w(),{t:a}=y(),o=te(),d=ae(),f=S(),x=ce();return t.isOutOfStock?e.jsx(Se,{}):(p=t.availabilityAt)!=null&&p.available?e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex space-x-5",children:[e.jsx("div",{children:e.jsx(Ce,{containerClassName:"w-[100px]",value:s.amount,inputClassName:"text-center",onChange:g=>i({...s,amount:g}),min:1,roundToDecimals:0,max:t.maxPurchaseQuantity})}),e.jsxs(M,{onClick:async()=>{const g=setTimeout(()=>{o==null||o.onOpenChange(!1)},300);try{await d(s,t),f||x("/pedir")}catch(c){throw clearTimeout(g),c}},className:"flex flex-1 items-center text-left",children:[e.jsx("div",{className:"flex-1",children:a(r?"green_bright_stingray_launch":"mad_away_liger_fry")}),e.jsx("div",{children:e.jsx(A,{number:n.price,format:"money"})})]})]}),r&&e.jsx("div",{className:"text-center",children:e.jsx(O,{className:"text-destructive text-sm",onClick:async()=>{o==null||o.onOpenChange(!1),await se(300),await d({...s,amount:0})},children:a("safe_knotty_snail_enrich")})})]}):e.jsx(Me,{})}function F(t){var n;const{image:s,product:i}=t;return(n=s.resizedData)!=null&&n.extraLargeURL?e.jsx("div",{className:"aspect-square",children:e.jsx(Ne,{loading:"eager",className:"aspect-square",imageClassName:"object-cover",src:s.resizedData.extraLargeURL,srcSet:q(s),smallSrc:s.resizedData.smallURL,alt:(i==null?void 0:i.altImg)||i.name})}):e.jsx("div",{className:"aspect-square bg-plain-foreground/10"})}function R(){return e.jsxs("div",{children:["Videos no soportados aun",e.jsx("div",{})]})}function we(t){var r;const{product:s}=t,i=S();if(!((r=s==null?void 0:s.images)!=null&&r.length)&&!s.urlVideo)return null;const n=(()=>{var a;return((a=s==null?void 0:s.images)==null?void 0:a.length)===1?s.urlVideo?e.jsx(R,{}):e.jsx(F,{product:s,image:s==null?void 0:s.images[0]}):e.jsx(ve,{opts:{loop:!0},children:e.jsx(be,{children:s.images.map((o,d)=>e.jsx(ye,{children:d===0&&s.urlVideo?e.jsx(R,{}):e.jsx(F,{product:s,image:o})},d))})})})();return e.jsx("div",{children:e.jsx("div",{className:v("overflow-hidden md:mt-0",{"md:rounded-l-lg":i,"rounded-lg sticky top-5":!i}),children:n})})}function Pe(t){var n,r,a,o;const{product:s}=t,{t:i}=y();return!s.isOutOfStock&&((n=s.availabilityAt)!=null&&n.available)?null:(r=s.availabilityAt)!=null&&r.available?e.jsx(I,{children:i("tired_active_anteater_pinch")}):(a=s.availabilityAt)!=null&&a.notAvailableMessage?e.jsx(I,{children:(o=s.availabilityAt)==null?void 0:o.notAvailableMessage}):e.jsx(I,{children:i("best_ideal_weasel_scoop")})}function Te({product:t,showPrice:s=!0}){const{availabilityAt:i,promotions:n}=t;if(!(n!=null&&n.length)||!i)return null;const{finalPrice:r}=i,a={price:r,promotionType:n[0].promotionType};return e.jsxs(e.Fragment,{children:[s&&e.jsx(Ie,{number:a.price}),e.jsx("div",{className:"",children:a.promotionType})]})}function Le(t){const{product:s}=t,i=s==null?void 0:s.informativeStamps,{t:n}=y();return e.jsxs("div",{className:"space-y-2",children:[e.jsx("h1",{className:"text-2xl font-bold",children:s.name}),e.jsx(Te,{product:s,showPrice:!1}),i&&!!i.length&&e.jsx("div",{className:"mb-3",children:e.jsx(xe,{stamps:i,iconOnly:!1})}),e.jsx(Pe,{product:s}),e.jsxs("p",{className:"text-muted-foreground dark:text-zinc-200",children:[e.jsx(_e,{children:s.description}),!!s.maxPurchaseQuantity&&e.jsx("span",{children:n("house_spare_wombat_reside",{max:s.maxPurchaseQuantity})})]})]})}function W(t){var a,o,d;const{product:s}=t,i=S(),n=he(),r=V();return e.jsxs(e.Fragment,{children:[!i&&e.jsx("div",{className:"mb-3",children:e.jsx(je,{children:e.jsxs(pe,{children:[e.jsx(C,{children:e.jsx(L,{asChild:!0,children:e.jsx(B,{to:"/pedir",children:r.name})})}),((a=s.categories)==null?void 0:a[0])&&e.jsxs(e.Fragment,{children:[e.jsx(D,{}),e.jsx(C,{children:e.jsx(L,{asChild:!0,children:e.jsx(B,{to:`/pedir/categoria/${(o=s.categories)==null?void 0:o[0]._id}`,children:(d=s.categories)==null?void 0:d[0].name})})})]}),e.jsx(D,{}),e.jsx(C,{children:e.jsx(ge,{children:s.name})})]})})}),e.jsxs("div",{className:v("grid md:grid-cols-2",{"gap-5":!i}),children:[e.jsx(we,{product:s}),e.jsx("div",{children:e.jsxs("div",{className:v("flex flex-col",{"md:aspect-square":i,"p-5 bg-plain rounded-lg":!i}),children:[e.jsxs("div",{id:"product-details-modifier-container",className:v("space-y-5",{"py-5 px-8 flex-1 md:overflow-auto":i}),children:[e.jsx(Le,{product:s}),e.jsx("div",{children:t.children})]}),e.jsx("div",{className:v("py-5 bg-plain border-t md:rounded-br-lg",{"sticky bottom-0":!i,"px-8 sticky bottom-0 md:relative":i}),style:{paddingBottom:n.bottom||20},children:t.actions})]})})]})]})}function H(t){return e.jsxs("div",{className:"flex items-center space-x-1 mr-3",children:[e.jsx("div",{className:t.count>0?"cursor-pointer":"text-muted-foreground",onClick:t.subtract,children:e.jsx(z,{className:"h-5 w-5"})}),e.jsx("div",{className:"text-sm w-4 text-center",children:e.jsx(A,{number:t.count,format:"integer"})}),e.jsx("div",{className:t.canAdd?"cursor-pointer":"text-muted-foreground",onClick:t.add,children:e.jsx(U,{className:"h-5 w-5"})})]})}function G(t){const{modifierOption:s}=t,i=s.availabilityAt;return s.isOutOfStock?e.jsx("div",{className:"text-destructive text-xs",children:"Fuera de stock"}):i.price?e.jsxs("div",{className:"text-xs text-muted-foreground",children:[i.price>=0?"+":"-"," ",e.jsx(A,{number:Math.abs(i.price),format:"money"})]}):null}function De(t){var n;const{modifierOption:s}=t,i=t.modifierOption.images[0];return i?e.jsxs("div",{className:v("space-y-2 pb-2 rounded-lg border overflow-hidden transition-all duration-100",{"ring-primary ring-2":t.count>0}),children:[e.jsxs("button",{className:"space-y-2 w-full",type:"button",onClick:t.defaultAction,children:[e.jsx("img",{src:((n=i.resizedData)==null?void 0:n.smallURL)??i.url,srcSet:q(i),alt:s.name,className:"w-full"}),e.jsx("div",{children:s.name}),e.jsx(G,{modifierOption:t.modifierOption})]}),t.type==="stepper"&&e.jsx("div",{className:"flex justify-center pl-3",children:e.jsx(H,{...t})})]}):null}function Be(t){return e.jsx(ue,{disabled:!t.count&&!t.canAdd,value:!!t.count,onChange:t.toggle})}function Fe(t){const s=b.useId(),i=b.useRef(`radio-${t.fieldName||s}-${fe()}`).current;return e.jsxs("div",{className:"relative flex items-start",children:[e.jsx("div",{className:"flex h-5 items-center pr-1.5",children:!t.disabled&&e.jsx("input",{id:i,"aria-describedby":`${i}-description`,name:t.fieldName,type:"checkbox",checked:!!t.value,onChange:()=>t.onChange(!t.value),className:"cursor-pointer border-none appearance-none w-2.5 h-2.5 ring-1 ring-offset-2 ring-muted-foreground rounded-full checked:bg-primary checked:ring-2 checked:ring-primary outline-none"})}),t.label||t.description?e.jsxs("div",{className:"ml-3 text-sm",children:[e.jsx("label",{htmlFor:i,className:"font-medium border-muted-foreground outline-none",children:t.label}),t.description&&e.jsx("p",{id:`${i}-description`,className:"border-muted-foreground",children:t.description})]}):null]})}function Re(t){const s=t.disabled;return e.jsx(Fe,{value:!!t.count,onChange:t.select,disabled:s})}function $e(t){return t.type==="radio"?e.jsx(Re,{...t}):t.type==="checkbox"?e.jsx(Be,{...t}):e.jsx(H,{...t})}function Ee(t){const{modifier:s,modifierOption:i,optionIds:n,setOptionIds:r}=t,a=i.isOutOfStock,o=n.filter(h=>h===i._id).length;let d=!0;i.max&&o>=i.max&&(d=!1),s.max&&n.length>=s.max&&(d=!1),a&&(d=!1);const f=()=>{d&&r(h=>[...h,i._id])},x=()=>{a||r(h=>{const j=h.indexOf(i._id);return j>-1&&h.splice(j,1),h})},p=()=>{n.includes(i._id)?x():f()},g=()=>{n.includes(i._id)?x():r([i._id])},c=s.max===1?g:i.max===1?p:f,l=s.max===1?"radio":i.max===1?"checkbox":"stepper",u=a,m={defaultAction:c,modifier:s,modifierOption:i,count:o,add:f,subtract:x,toggle:p,select:g,canAdd:d,type:l,disabled:u};return s.isImageModifier?e.jsx(De,{...m}):e.jsxs("div",{className:"flex space-x-5 py-2 min-h-12 items-center",children:[e.jsxs("button",{type:"button",className:"flex-1 block text-left",onClick:c,disabled:u,children:[e.jsx("div",{className:"text-sm",children:i.name}),e.jsx(G,{modifierOption:i})]}),e.jsx("div",{children:e.jsx($e,{...m})})]})}function Ve(t){const{min:s,max:i}=t,{t:n}=y(),r=()=>s===i?e.jsx(_,{children:n("swift_green_termite_pout",{min:s})}):s?e.jsx(_,{children:n("fun_elegant_parakeet_hike",{min:s})}):e.jsx(_,{children:n("lofty_zippy_moose_savor",{max:i})});return e.jsx("div",{className:"space-x-5",children:r()})}function qe(t){const{modifier:s,value:i,onChange:n}=t,{t:r}=y(),a=!!s.optional,o=r(a?"aloof_livid_reindeer_urge":"wide_seemly_puma_rest"),d=b.useMemo(()=>s.options.filter(f=>{var x;return(x=f.availabilityAt)==null?void 0:x.available}),[s.options]);return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(E,{className:"flex-1",children:s.name}),e.jsx("div",{children:e.jsx(I,{variant:s.optional?"secondary":"default",className:"float-right",children:o})})]}),s.description&&e.jsx(_,{children:s.description}),e.jsx(Ve,{optional:s.optional,min:s.min,max:s.max,selected:i==null?void 0:i.length})]}),e.jsx("div",{className:v({"divide-y":!s.isImageModifier,"grid grid-cols-2 lg:grid-cols-3 gap-5":s.isImageModifier}),children:d.map(f=>e.jsx(Ee,{optionIds:i||[],setOptionIds:n,modifierOption:f,modifier:s,isImage:s.isImageModifier},f._id))})]})}function ze(){const{state:t,setState:s,filteredModifiers:i,product:n}=w(),r=V(),{t:a}=y(),[o,d]=b.useState(null),f=(c,l)=>l.filter(u=>c.options.some(m=>m._id===u)),x=(c,l)=>{const u=l.find(j=>j.modifierId===c._id),m=(u==null?void 0:u.optionsIds)??[],h=f(c,m);return{modifierId:c._id,optionsIds:h}},p=c=>{const l=oe(n.modifiers,c),u=c.modifiers??[];return l.map(m=>x(m,u))};b.useEffect(()=>{const c=Array.isArray(t.modifiers)?t.modifiers:[],l=p(t);(c.length!==l.length||c.some((m,h)=>{const j=l[h];return!j||m.modifierId!==j.modifierId||m.optionsIds.length!==j.optionsIds.length||m.optionsIds.some((J,K)=>J!==j.optionsIds[K])}))&&s(m=>({...m,modifiers:l}))},[t.modifiers,i]);const g=c=>{const l=p(c);s({...c,modifiers:l})};return de.useOnEvent("addToCart.missingModifier",c=>{d(c._id),setTimeout(()=>d(null),2e3);const l=document.getElementById(`modifier-${c._id}`);if(!l)return;const u=document.getElementsByClassName("data-drawer-container")[0];if(u){setTimeout(()=>{u.scrollTo({top:l.offsetTop-20,behavior:"smooth"})},100);return}const m=document.getElementById("product-details-modifier-container");m&&m.scrollTo({top:l.offsetTop-20,behavior:"smooth"})}),e.jsxs("div",{children:[e.jsxs(N.Form,{state:t,onChange:g,className:"space-y-5",children:[i.map(c=>{var u;const l=((u=t.modifiers)==null?void 0:u.findIndex(m=>m.modifierId===c._id))??-1;return l===-1?null:e.jsx("div",{id:`modifier-${c._id}`,className:v("animated",{"animate-shake":o===c._id}),children:e.jsx(N.Field,{fieldName:`modifiers.${l}`,type:le,children:e.jsx(N.Field,{fieldName:"optionsIds",type:qe,modifier:c})})},c._id)}),r.menuConfiguration.blockCommentsOnProducts?null:e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{children:a("brave_upper_dove_leap")}),e.jsx(N.Field,{fieldName:"comment",placeholder:a("gaudy_sad_mallard_renew"),type:me})]})]}),e.jsx("div",{className:"h-12"})]})}function _t(){const{product:t}=w(),s=Y(i=>i.preferences);return X(i=>{t!=null&&t._id&&i.productViewed(t,s)},[t==null?void 0:t._id]),e.jsx(W,{actions:e.jsx(Ae,{}),product:t,children:e.jsx(ze,{})})}function It({product:t,cartItem:s,children:i}){const n=ke(t,s);return e.jsx(Q.Provider,{value:n,children:i})}function Ct(t){const s=k(i=>{var n;return(n=i==null?void 0:i.productsData)==null?void 0:n.productsMap[t.productId]});return s?e.jsx(W,{product:s,children:e.jsx(T,{})}):e.jsx(T,{})}export{It as C,_t as O,Ct as P,U as a};
