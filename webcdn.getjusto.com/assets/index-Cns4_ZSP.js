import{r as h,j as e,g as Te}from"./jsx-runtime-BGxL3LVy.js";import{b as Le,S as Z}from"./index-D-adSmCD.js";import{g as Me}from"./seoMetaTags-BsljWNxe.js";import{i as V,j as $e}from"./env-D6s-xqZ4.js";import{u as C,a as T,n as ee,d as Fe,e as We,O as Re}from"./index-CohxQZEM.js";import{u as He}from"./hooks-BXGtQO4o.js";import{C as S}from"./Container-Cn3YuP-m.js";import{C as oe}from"./ClientOnly-C9d8okrb.js";import{M as D}from"./index-DQcw9fEh.js";import{c as de,u as J,g as le,m as ze,f as Ee}from"./index-Dg1ijqza.js";import{c as N}from"./utils-mMyIM9tf.js";import{a as x}from"./index-DUyAALTD.js";import{u as _,a as Q,b as Ve}from"./useWebsite-B2NA3eOh.js";import{u as Ue,O as ce}from"./TimeButton-C3VNtdr7.js";import{B as R,a as H,b as B,c as L,d as M,e as z}from"./breadcrumb-CmxDwxpD.js";import{u as ue}from"./useActiveCategory-BOgNxwo5.js";import{L as I,u as qe,a as Ye,A as Je}from"./components-C7TJjWXG.js";import{A}from"./index-Bzd9UY_1.js";import{a as Qe}from"./useDebouncedValue-HavTh-j-.js";import{P as Ge,C as Ke,O as Xe,a as Ze}from"./index-CVR8IHKf.js";import{O as me,N as pe,T as er,a as rr}from"./AddressButton-ABHnG3sb.js";import{W as re,C as sr,a as tr,u as se}from"./NoItems-iZFDApAL.js";import{B as O}from"./index-cWEE_j1p.js";import{f as ir}from"./index-Dh_ekISa.js";import{B as fe}from"./badge-DAjfRXK0.js";import{d as $}from"./dayjs.min-C_B9Zj0p.js";import{$ as ar,W as nr}from"./apollo-hooks.es-DZ97-Of4.js";import{g as he}from"./gql-CqV_3job.js";import{u as k}from"./useTranslation-B_PywvDf.js";import{F as E}from"./index-DhFb9xq3.js";import{b as xe}from"./index-DYTzf-DC.js";import{B as or}from"./button-B9Ixe4GG.js";import{u as W,P as ge}from"./useProductCardDesignData-DVnwvHwE.js";import{u as je}from"./useProductState-Dtp7AN7_.js";import{T as dr,a as lr,P as cr}from"./react-icons.esm-D-bY5_Bc.js";import{O as F}from"./index-C7wa7IgK.js";import{C as ur,a as mr,b as pr}from"./Price-CKp0TGgO.js";import{F as ve}from"./index-BALO_H0H.js";import{u as fr}from"./loginViaAuth-CQHEdACz.js";import{C as U}from"./card-DshXsK29.js";import{u as hr}from"./isJustoApp-DujzpsFs.js";import{S as q}from"./skeleton-jaTN8ZDn.js";import{S as be}from"./shopping-bag-DGgdUTTN.js";import{u as xr}from"./useSearchParams-R8k8eN7N.js";import{u as gr}from"./useThrottledCallback-BjH78-KN.js";import{g as P}from"./get-MdeaVaBp.js";import{c as Ce}from"./createLucideIcon-gj9TAl09.js";import{u as ye,a as Ne,q as Y,p as jr,O as te}from"./index-CXeFjl5i.js";import{W as vr}from"./index-NSQ-vbUo.js";import{r as ie}from"./range-CqIzUPl_.js";import{u as br}from"./useHydrated-DGqRnkd3.js";import{a as Cr,b as yr,c as Nr}from"./tooltip-saQE01Fr.js";import"./index-B7S20zKg.js";import"./clsx-B-dksMZM.js";import"./index-BJLV6hUK.js";import"./index-BHERncwe.js";import"./index-CB_6DRz4.js";import"./index-CylivXx-.js";import"./index-Dz7ujoPl.js";import"./tslib.es6-B4nGuNfR.js";import"./identity-CwXImgea.js";import"./index-DR85t-yO.js";import"./dropdown-menu-YfhecZr1.js";import"./index-BLnOCR5Q.js";import"./Combination-DP3is0_f.js";import"./index-BUY6SKgV.js";import"./Context-BxTGfssI.js";import"./useStateWithTransition-BEN_QdyR.js";import"./useLocalStorage-DsJe66XE.js";import"./module-_ASt7nc-.js";import"./index-u35E67kG.js";import"./parser-CklOqoDN.js";import"./isEqual-iux_d1W7.js";import"./get---A8iXU-.js";import"./_isIterateeCall-2n3a4jSQ.js";import"./max-DoGq9HeY.js";import"./useWidth-DE4cobY2.js";import"./dialog-bcszeN6R.js";import"./index-7UdPD0wL.js";import"./Context-BarPatdd.js";import"./index-Bt5S1wHf.js";import"./index-G4ASVU0t.js";import"./index-BFQuIHSE.js";import"./index-D0IKzcAI.js";import"./round-BOm5nOcu.js";import"./index-DnxNFHVa.js";import"./input-DCrp_ykE.js";import"./sleep-BvINh1mj.js";import"./index-Dpcw64aj.js";import"./index-BbH7TfgA.js";import"./index-DCntFPjS.js";import"./getImageSrcSet-Duns6C57.js";import"./index-BJo8DL8B.js";import"./uniqueId-DlOYuaFD.js";import"./carousel-WfFnvB-S.js";import"./index-CCl8e3Fs.js";import"./popover-LlYgTbu8.js";import"./locales-BYfpgGDl.js";import"./context-D6yqZfdz.js";import"./ProductImage-D9_CEa6B.js";import"./_createAggregator-BbUU9R1n.js";import"./index-DVEwTJaE.js";import"./react-error-boundary.esm-Bqh86cdX.js";import"./gql-CRk4Ju9I.js";import"./clock-0brtFX_G.js";import"./orionjs-react-autoform.es-DuIzeafz.js";import"./index-db-UEeGV.js";import"./coordinatesDistance-Q1p1zoOx.js";import"./isMobile-7q270MqN.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Or=Ce("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wr=Ce("EllipsisVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);let ae=!1;function Oe(){return V?!1:(h.useLayoutEffect(()=>{ae=!0},[]),ae)}function G(r){const[s,t]=h.useState(0);return h.useEffect(()=>{const n=document.getElementById(r);n&&t(n.clientHeight)},[r]),s}function Ir(){return G("orderBar")}function we(){return G("orderNavigationBar")}function K(){return G("headerSticky")}function _r(){const r=ue(),s=_(),t=C(o=>{var d;return(d=o==null?void 0:o.productsData)==null?void 0:d.categoriesMap}),n=C(o=>{var d,l;return((d=o==null?void 0:o.productsData)==null?void 0:d.isSearch)||((l=o==null?void 0:o.productsData)==null?void 0:l.searchLoading)}),i=C(o=>o==null?void 0:o.searchFilter),a=Ue(t),u=a==null?void 0:a[r];return i?e.jsx("div",{className:"mb-3",children:e.jsx(R,{children:e.jsxs(H,{children:[e.jsx(B,{children:e.jsx(L,{asChild:!0,children:e.jsx(I,{to:"/pedir",children:s.name})})}),e.jsx(M,{}),e.jsx(B,{children:e.jsxs(z,{children:['Busqueda "',i,'"']})})]})})}):!u||n?null:u.parentCategory?e.jsx("div",{className:"mb-3",children:e.jsx(R,{children:e.jsxs(H,{children:[e.jsx(B,{children:e.jsx(L,{asChild:!0,children:e.jsx(I,{to:"/pedir",children:s.name})})}),e.jsx(M,{}),e.jsx(B,{children:e.jsx(L,{asChild:!0,children:e.jsx(I,{to:`/pedir/categoria/${u.parentCategory._id}`,children:u.parentCategory.name})})}),e.jsx(M,{}),e.jsx(B,{children:e.jsx(z,{children:u.name})})]})})}):e.jsx("div",{className:"mb-3",children:e.jsx(R,{children:e.jsxs(H,{children:[e.jsx(B,{children:e.jsx(L,{asChild:!0,children:e.jsx(I,{to:"/pedir",children:s.name})})}),e.jsx(M,{}),e.jsx(B,{children:e.jsx(z,{children:u.name})})]})})})}function Br(){const r=x(i=>{var a;return(a=i==null?void 0:i.preferences)==null?void 0:a.store}),s=x(i=>{var a;return(a=i==null?void 0:i.preferences)==null?void 0:a.deliverAt}),t=Q(),{data:n}=ar({clientName:de.main,query:he(`query getStoreCapacityForNextOpenDate($storeId: ID, $websiteId: ID!, $deliverAt: Date) {
      store(storeId: $storeId) {
        _id
        nextAvailableDate
        schedulingOrdersDays
        hasOrderCapacity(date: $deliverAt)
      }
      website(websiteId: $websiteId) {
        _id
        limitOrdersBySlot
      }
    }`),omit:!(r!=null&&r._id)||(r==null?void 0:r.itsOpenNow),variables:{websiteId:t,storeId:r==null?void 0:r._id,deliverAt:s}});return n}function Ie(r){const{store:s,website:t}=Br(),n=x(c=>{var p;return(p=c==null?void 0:c.preferences)==null?void 0:p.deliverAt}),{t:i}=k(),a=x(c=>c.setChooseTimeOpen);if(!s)return null;const u=!(s!=null&&s.hasOrderCapacity)&&(t!=null&&t.limitOrdersBySlot)?i("swift_fuzzy_alpaca_pat"):null,o=s.nextAvailableDate,d=s.schedulingOrdersDays,l=N(r.className);if(u)return e.jsx("div",{className:l,children:u});if(!o)return e.jsx("div",{className:l,children:i("brief_plane_samuel_savor")});const m=$(o);return n&&$(n).isAfter(m)&&(t!=null&&t.limitOrdersBySlot)?null:m.isSame($(),"day")?d?e.jsx("button",{type:"button",onClick:()=>a(!0),className:l,children:i("mean_free_walrus_fetch",{date:m.format("HH:mm")})}):e.jsx("div",{className:l,children:i("weird_still_chicken_savor",{date:m.format("HH:mm")})}):m.isSame($().add(1,"day"),"day")?d>=2?e.jsx("button",{type:"button",onClick:()=>a(!0),className:l,children:i("pretty_mad_giraffe_laugh")}):e.jsx("div",{className:l,children:i("strong_sweet_newt_rest",{date:m.format("HH:mm")})}):d>=3?e.jsx("button",{type:"button",onClick:()=>a(!0),className:l,children:i("east_vivid_goose_succeed",{date:m.format("dddd D [de] MMMM")})}):e.jsx("div",{className:l,children:i("even_green_gopher_chop",{date:m.format("LL"),hour:m.format("HH:mm")})})}function Sr(){var s;const r=x(t=>t.cart);return(s=r==null?void 0:r.items)!=null&&s.length?e.jsxs("div",{className:"",children:[r.totalDiscounts===0?null:e.jsxs("div",{className:"flex text-sm",children:[e.jsx("div",{className:"flex-1",children:"Total Productos"}),e.jsx("div",{children:e.jsx(E,{number:r.itemsPriceWithoutDiscount})})]}),r.totalDiscounts===0?null:e.jsxs("div",{className:"flex text-sm",children:[e.jsx("div",{className:"flex-1",children:"Descuentos"}),e.jsxs("div",{children:["- ",e.jsx(E,{number:r.totalDiscounts})]})]}),e.jsxs("div",{className:"flex font-semibold text-sm",children:[e.jsx("div",{className:"flex-1",children:"Subtotal"}),e.jsx("div",{children:e.jsx(E,{number:r.itemsPriceWithoutLoyaltyDiscount})})]})]}):null}function _e({disabled:r}){return e.jsx(O,{asChild:!0,className:"w-full",disabled:r,children:e.jsx(I,{to:"/auth/login-external-provider",prefetch:"viewport",children:"Continuar"})})}function kr({disabled:r}){return e.jsx(e.Fragment,{children:e.jsx("div",{className:"space-y-2",children:e.jsx(_e,{disabled:r})})})}function Pr({disabled:r}){return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"p-2 bg-muted rounded-md",children:["Al dar Continuar, aceptarás los"," ",e.jsx("a",{className:"text-primary",href:"https://yape.tambo.pe/documentos-legales/termsAndConditions",children:"términos y condiciones"}),","," ",e.jsx("a",{className:"text-primary",href:"https://yape.tambo.pe/documentos-legales/privacy",children:"políticas de privacidad"})," ","y compartir tus datos personales con Yape Tambo. Esta autorización solo se realizará en tu primera compra"]}),e.jsx(_e,{disabled:r})]})})}function Be(){var o;const r=x(d=>d.preferences),s=x(d=>d.cart),{t}=k(),n=(r==null?void 0:r.store)&&!((o=r==null?void 0:r.store)!=null&&o.itsOpenAtTime),i=J(),{userId:a}=le(),u=!(r!=null&&r.store)||s.hasOutOfStockItems||!!s.amountToReachMinimum||n;return e.jsx(e.Fragment,{children:a||!i.loggedOutCartContinueButtonMode||u?e.jsx(O,{asChild:!0,variant:u?"muted":"default",className:"w-full",disabled:u,children:u?e.jsx("span",{children:t("just_aloof_hamster_pat")}):e.jsx(I,{to:"/checkout",prefetch:"viewport",children:t("just_aloof_hamster_pat")})}):i.loggedOutCartContinueButtonMode==="yape"?e.jsx(Pr,{disabled:u}):i.loggedOutCartContinueButtonMode==="daleCo"?e.jsx(kr,{disabled:u}):e.jsx("div",{children:"si es que agrega otro acá, ordenemos este archivo"})})}function Dr(r){const{t:s}=k(),{open:t,setOpen:n}=r,i=W("row-fast");return e.jsxs(e.Fragment,{children:[e.jsx(D,{open:t,size:"md",noPadding:!0,onOpenChange:a=>{n(a),a||r.onDismiss()},children:e.jsxs("div",{className:"flex flex-col overflow-hidden max-h-[calc(100dvh-6rem)] md:max-h-[calc(100dvh-8rem)]",children:[e.jsx(xe,{className:"px-5 py-3",children:s("few_even_panda_boost")}),e.jsx("div",{className:"border-t flex-1 p-5 space-y-5 overflow-scroll scroll-smooth",children:r.upsellingProducts.map(a=>e.jsx("div",{children:e.jsx(ge,{design:i,product:a})},a._id))}),e.jsx("div",{className:"border-t px-5 py-3",children:e.jsx(Be,{})})]})}),e.jsx(or,{className:"w-full",onClick:()=>n(!0),children:s("just_aloof_hamster_pat")})]})}function Ar(r){const s=x(d=>{var l;return(l=d.preferences)==null?void 0:l.storeId}),t=x(d=>{var l;return(l=d.preferences)==null?void 0:l.menuId}),n=Q(),i=x(d=>{var l;return((l=d.cart)==null?void 0:l.items.map(m=>m.product._id))||[]}),[a,u]=h.useState(null);h.useEffect(()=>{if(r)return;const d={storeId:s,menuId:t,websiteId:n,forProductIdsInCart:i};JSON.stringify(a)!==JSON.stringify(d)&&u(d)},[s,t,i,r]);const{data:o}=nr({clientName:de.main,query:he(`query getUpsellingProducts (
      $forProductIdsInCart: [ID]
      $menuId: ID
      $storeId: ID
      $websiteId: ID
    ) {
      upsellingProducts (
        forProductIdsInCart: $forProductIdsInCart
        menuId: $menuId
        storeId: $storeId
        websiteId: $websiteId
      ) {
        ...AsWebdataProductDTO
      }
    }
    
    fragment AsWebdataProductDTO on Product {
      _id
      websiteId
      menuId: _id # no se usa el menuId, pero igual lo trae. hay que ponerlo para que TS no alegue
      name
      isOutOfStock(storeId: $storeId)
      description
      externalId
      priority
      altImg
      titleImg
      urlVideo
      informativeStamps
      path
      availabilityAt(menuId: $menuId) {
        menuId
        available
        visible: available
        basePrice
        finalPrice
        notAvailableMessage
        hideDiscountBadge
      }
      images {
        ...AsWebdataImageDTO
      }
      categories {
        _id
        name
        index
      }
      maxPurchaseQuantity
      modifiers {
        ...AsWebdataModifierDTO
      }
    }
    
    fragment AsWebdataModifierDTO on Modifier {
      _id
      name
      shortName
      description
      min
      max
      optional
      isImageModifier
      options {
        ...AsWebdataModifierOptionDTO
      }
    }
    
    fragment AsWebdataModifierOptionDTO on ModifierOption {
      _id
      name
      isOutOfStock(storeId: $storeId)
      max
      requiresModifierOptionIds
      requiresAtLeastOneModifierOption
      availabilityAt (menuId: $menuId) {
        available
        menuId
        price
      }
      images: image {
        ...AsWebdataImageDTO
      }
    }

    fragment AsWebdataImageDTO on Image {
      _id
      url
      colorsData {
        blurhash
      }
      dimensions {
        height
        width
      }
      resizedData {
        thumbnailURL
        smallURL
        mediumURL
        largeURL
        extraLargeURL
      }
    }
    `),skip:!(i!=null&&i.length)||!s||!t||!a,variables:a});return o.upsellingProducts||[]}function Tr(){var c,p;const r=x(v=>v.preferences),s=x(v=>v.cart),{t}=k(),n=Ve(),i=(r==null?void 0:r.store)&&!((c=r==null?void 0:r.store)!=null&&c.itsOpenAtTime),a=x(v=>v.setChoosePlaceOpen),[u,o]=h.useState(!1),d=Ar(u),[l,m]=h.useState(!1);return(p=s==null?void 0:s.items)!=null&&p.length?e.jsxs("div",{className:"space-y-5 pt-5",children:[e.jsx(Sr,{}),r!=null&&r.store?s.hasOutOfStockItems?e.jsx(re,{className:"text-center",children:t("fun_lazy_seal_slurp")}):s.amountToReachMinimum?e.jsx(re,{className:"text-center",children:t("mellow_elegant_rook_expand",{money:ir(s.amountToReachMinimum,"money",n)})}):null:e.jsx(O,{className:"max-w-full text-wrap p-2",size:"auto",variant:"warning",onClick:()=>a(!0),children:t("gross_upper_florian_dart")}),i&&e.jsx(h.Suspense,{fallback:null,children:e.jsx("div",{className:"flex justify-center",children:e.jsx(fe,{variant:"destructive",className:"",children:e.jsx(Ie,{className:"font-normal"})})})}),d!=null&&d.length&&!l?e.jsx(Dr,{open:u,setOpen:o,upsellingProducts:d,onDismiss:()=>m(!0)}):e.jsx(Be,{})]}):null}function Lr(r){var u;const{item:s,openUpdateItem:t}=r,n=je(),{t:i}=k(),a={amount:s.amount,comment:s.comment,modifiers:(u=s.modifiers)==null?void 0:u.map(o=>({modifierId:o.modifierId,optionsIds:o.optionsIds})),productId:s.productId,cartItemId:s._id};return s.outOfStockMessage?e.jsxs("div",{className:"flex justify-between space-x-2",children:[e.jsx(fe,{variant:"destructive",children:s.outOfStockMessage}),e.jsx(F,{className:"h-6 bg-muted text-plain-foreground rounded-full px-2 text-xs",onClick:()=>n({...a,amount:0}),children:i("left_dirty_fish_buzz")})]}):e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{children:e.jsxs("div",{className:"flex h-6 bg-muted text-plain-foreground rounded-full items-center justify-center px-2 space-x-2",children:[e.jsx(F,{onClick:async()=>{n({...a,amount:a.amount-1})},children:a.amount===1?e.jsx(dr,{}):e.jsx(lr,{})}),e.jsx("div",{children:s.amount}),e.jsx(F,{onClick:async()=>{n({...a,amount:a.amount+1})},children:e.jsx(cr,{})})]})}),e.jsx(F,{className:"h-6 bg-muted text-plain-foreground rounded-full px-2 text-xs",onClick:t,children:i("civil_bald_gibbon_fall")})]})}function Mr(r){const{item:s,openUpdateItem:t}=r,n=je();return s.product?e.jsxs("div",{className:"flex space-x-2 py-3",children:[e.jsx(ur,{product:s.product}),e.jsxs("div",{className:"flex-1 space-y-1",children:[e.jsxs("div",{className:N("flex justify-between space-x-2",{"text-muted-foreground":s.isOutOfStock}),children:[e.jsx(mr,{item:s,hideAmount:!0}),e.jsx(pr,{item:s})]}),e.jsx("div",{children:e.jsx(Lr,{item:s,openUpdateItem:t})})]})]}):e.jsxs("div",{className:"flex space-x-2 py-3",children:[e.jsx("div",{children:"Hay un error con un producto"}),e.jsx(O,{onClick:()=>n({amount:0,comment:null,modifiers:[],productId:"unknown",cartItemId:s._id}),children:"Eliminar"})]})}function Se(){var v,f,g;const{t:r}=k(),s=x(j=>j.cart),t=x(j=>{var y;return(y=j.preferences)==null?void 0:y.menuId}),n=T(),i=Q(),[a,u]=h.useState(),[o,d]=h.useState(!1),l=h.useMemo(()=>{var j;return(j=s==null?void 0:s.items)==null?void 0:j.find(y=>y._id===a)},[s==null?void 0:s.items,a]),m=((v=s==null?void 0:s.items)==null?void 0:v.reduce((j,y)=>j+y.amount,0))||0,{data:c,loading:p}=Qe(`/v1/websites/${i}/menus/${t||"default"}/products/${(f=l==null?void 0:l.product)==null?void 0:f._id}`,{skip:!(l!=null&&l.productId)});return e.jsxs("div",{className:N("flex flex-col text-sm divide-y overflow-hidden",{"max-h-[calc(100dvh-6rem)] md:max-h-[calc(100dvh-8rem)]":n==="withCart","max-h-[calc(100dvh-6rem)]":n!=="withCart"}),children:[e.jsxs("div",{className:"pb-5 space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2 justify-between",children:[e.jsxs(A,{size:"h3",className:"flex-1",children:[r("teary_loud_felix_zip")," ",m?`(${m})`:null]}),e.jsx(ce,{variant:"cart"})]}),e.jsx(me,{variant:"cart"})]}),e.jsx("div",{className:"overflow-auto flex-1 py-1",children:(g=s==null?void 0:s.items)!=null&&g.length?e.jsx("div",{className:"divide-y",children:s.items.map(j=>e.jsx(Mr,{item:j,openUpdateItem:()=>{u(j._id),d(!0)}},j._id))}):s?e.jsx(sr,{}):e.jsx(tr,{})}),e.jsx(Tr,{}),e.jsx(D,{noPadding:!0,size:"7xl",open:a&&o,onOpenChange:d,children:l&&(p||(c==null?void 0:c._id)!==l.productId?e.jsx(Ge,{productId:l.productId}):e.jsx(Ke,{product:c,cartItem:l,children:e.jsx(Xe,{})},l._id))})]})}function $r(){const r=x(s=>{var t;return(t=s==null?void 0:s.preferences)==null?void 0:t.store});return!r||r.itsOpenNow?null:e.jsx(h.Suspense,{fallback:null,children:e.jsx("div",{className:"dark:bg-muted dark:text-plain-foreground bg-primary text-primary-foreground",children:e.jsx(S,{children:e.jsx("div",{className:"flex items-center justify-center py-2 text-base",children:e.jsx(Ie,{})})})})})}function Fr(){const r=_(),{userId:s}=le(),{t}=k(),n=r.loyaltyProgramConfig,i=fr(),a=x(o=>!o.me),u=x(o=>{var d;return(d=o.me)==null?void 0:d.websiteCoinsBalance});return n!=null&&n.active?s?a?null:e.jsx(U,{className:"p-5 flex items-center space-x-5",children:e.jsxs("div",{children:[e.jsxs(A,{size:"h3",className:"",children:["Tienes ",e.jsx(ve,{number:u,format:"integer"})," ",e.jsx("span",{className:"orderLoyaltyProgramName",children:n.name})]}),e.jsx("div",{children:t("kind_game_lynx_view")})]})}):e.jsxs(U,{className:"p-5 flex items-center space-x-5 justify-between",children:[e.jsxs("div",{children:[e.jsxs(A,{size:"h3",className:"",children:["Acumula ",e.jsx("span",{className:"orderLoyaltyProgramName",children:n.name})]}),e.jsx("div",{children:t("bold_only_salmon_cook")})]}),e.jsx(O,{onClick:()=>i(),children:t("dark_bald_piranha_hint")})]}):null}function ke(){return e.jsx(oe,{children:e.jsx(Fr,{})})}function Wr({orderLayout:r}){const s=r==="withCart";return e.jsx("div",{className:`col-span-3 flex justify-center my-5 ${s?"md:hidden":""}`,children:e.jsx("div",{className:"w-full md:w-[66.66%]",children:e.jsx(ke,{})})})}function Pe(){const r=x(s=>s.cart);return r?e.jsx(ve,{number:r.itemsPriceWithOnlyItemsDiscount,format:"money"}):e.jsx(q,{className:"w-[50px] h-[18px] bg-primary-foreground/60"})}function Rr(){const r=C(a=>a==null?void 0:a.setCartOpen),s=x(a=>{var u;return(u=a.cart)==null?void 0:u.items})||[],t=hr(),n=(s==null?void 0:s.reduce((a,u)=>a+u.amount,0))||0;return J().showOrderComponentsInNavbar?null:e.jsx("div",{className:"fixed bottom-0 left-0 right-0 flex items-center justify-center",children:e.jsx(O,{onClick:()=>r(!0),style:{bottom:Math.max(t.bottom,20)},className:N("md:hidden transition-all  left font-bold text-left flex items-center fixed h-14 text-base rounded-full bg-primary text-primary-foreground",{"translate-y-32":!n,"translate-y-0":n}),children:e.jsxs("div",{className:"flex-1 flex items-center space-x-5 px-3",children:[e.jsx("div",{children:e.jsx(Pe,{})}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute -top-2 -right-2.5 text-xs rounded-full min-w-[18px] px-1 h-[18px] flex items-center justify-center bg-primary border-2 border-primary-foreground",children:n}),e.jsx(be,{className:"w-5"})]})]})})})}const Hr=h.memo(function(s){const{startOfView:t}=s,n=h.useRef(0);n.current=t;const i=C(c=>{var p;return(p=c==null?void 0:c.productsData)==null?void 0:p.categories}),[a,u]=h.useState(),o=h.useRef(null),[d]=xr("categoria"),l=gr(()=>{for(const c of[...i].reverse()){const p=document.getElementById(`cat-${c._id}`);if(!p)continue;if(p.getBoundingClientRect().top<t){u(c._id);return}}},200),m=c=>{const p=document.getElementById(`cat-${c}`);if(!p)return;const v=p.getBoundingClientRect().top+window.scrollY-n.current+1;setTimeout(()=>{window.scrollTo({top:v,behavior:"smooth"})})};return h.useEffect(()=>{if(V)return;const c=document.getElementById(`cat-button-${a}`);if(!c)return;const p=c.offsetLeft-o.current.offsetLeft;o.current.scrollTo({left:p,behavior:"smooth"})},[a]),h.useEffect(()=>{if(!V&&i!=null&&i.length)return window.addEventListener("scroll",l),()=>{window.removeEventListener("scroll",l)}},[l]),h.useEffect(()=>{if(!d)return;const c=i==null?void 0:i.find(p=>ee(p.name)===ee(d).replace(/\-/g,"")||p._id===d);c&&setTimeout(()=>{m(c._id)},200)},[d]),e.jsx("div",{className:"flex space-x-3 flex-1 overflow-auto text-base",ref:o,children:i==null?void 0:i.map(c=>{const p=c._id===a;return e.jsx(O,{id:`cat-button-${c._id}`,size:"auto",variant:"opacity",onClick:()=>m(c._id),className:N("orderNavigationBarCategory border-b-2 rounded-none text-base h-12 flex items-center",{"border-primary orderNavigationBarCategoryActive":p,"border-transparent":!p}),children:c.name},c._id)})})});async function De(r){const s=`${ze.webdata.urls[$e]}${r}`;return(await(await fetch(s)).json()).data}async function zr(r){const s=`/v1/websites/${r}/categoriesBrand`;return await De(s)}async function Er(r,s){const t=`/v1/websites/${r}/categoriesMinimal/${s}`;return await De(t)}function Vr(r){return P(r,"brand.categoriesImage.url")?e.jsx("button",{type:"button",onClick:r.onClick,children:e.jsx("img",{className:"inline-block h-12 mr-2 cursor-pointer mb-0 align-bottom brand-bar-image",src:r.brand.categoriesImage.url,alt:r.brand.name})}):null}function Ur(r){const s=h.useRef(r.startOfView),t=_(),i=x(m=>{var c;return(c=m.preferences)==null?void 0:c.menuId})||t.defaultMenuId,[a,u]=h.useState(null),o=(m,c)=>Array.isArray(m)?m.filter(p=>new Set(Array.isArray(c)?c.map(v=>v._id):[]).has(p._id)):[];if(h.useEffect(()=>{async function m(){if(!t._id)return;const[c,p]=await Promise.all([zr(t._id),Er(t._id,i)]);u(o(c,p))}m()},[t._id,i]),!a)return null;let d=null;const l=m=>{const c=document.getElementById(`cat-${m}`);if(!c)return;const p=c.getBoundingClientRect().top+window.scrollY-s.current+1;setTimeout(()=>{window.scrollTo({top:p,behavior:"smooth"})})};return e.jsx("div",{className:"overflow-auto touch-auto whitespace-nowrap scroll-smooth px-1 sm:px-5",children:a.map(m=>{let c=null;m.brand&&m.brand._id!==d&&(c=m.brand,d=c._id);const p=c?e.jsx(Vr,{brand:c,onClick:()=>{l(m._id)}},`brand_${c._id}`):null;return!m.brand&&d&&(d=null),p?e.jsx(h.Fragment,{children:p},`cat_${m._id}`):null})})}function qr({startOfView:r}){return e.jsx(Ur,{startOfView:r})}function Yr(){const r=_(),s=C(l=>{var m;return(m=l==null?void 0:l.productsData)==null?void 0:m.categories}),t=K(),n=we(),i=Ir(),a=n+i+t+20,[u,o]=h.useState(!1),d=C(l=>l==null?void 0:l.searchFilter);return e.jsxs("div",{id:"orderNavigationBar",className:"orderNavigationBar bg-navbar text-navbar-foreground border-b truncate max-w-full",children:[e.jsx(D,{force:"drawer",open:u,onOpenChange:o,children:e.jsx(S,{children:e.jsx("div",{className:"text-left space-y-2 py-5",children:s==null?void 0:s.map(l=>e.jsx(O,{size:"auto",variant:"opacity",onClick:()=>{o(!1);const m=document.getElementById(`cat-${l._id}`);if(!m)return;const c=m.getBoundingClientRect().top+window.scrollY-a+1;setTimeout(()=>{window.scrollTo({top:c,behavior:"smooth"})})},className:"flex text-foreground hover:text-primary",children:e.jsx(xe,{children:l.name})},l._id))})})}),e.jsx(S,{className:"",children:e.jsxs("div",{className:"orderNavigationBarInner flex items-center space-x-3",children:[e.jsx(pe,{variant:"compact"}),!d&&e.jsxs(e.Fragment,{children:[r!=null&&r.isMultiBrand?e.jsx(qr,{startOfView:a}):e.jsx(Hr,{startOfView:a}),e.jsx(O,{"aria-label":"Ver categorías",size:"icon",variant:"opacity",onClick:()=>o(!u),children:e.jsx(wr,{className:"w-5 h-5"})})]})]})})]})}function Jr(){const r=C(o=>{var d;return(d=o==null?void 0:o.productsData)==null?void 0:d.categoriesTree}),s=_(),t=r||(s==null?void 0:s.categoryTree),n=ye(),[i,a]=h.useState(!1),u=h.useMemo(()=>{const o=d=>{var l,m;return{id:d._id,name:e.jsx("div",{className:"text-base font-bold",children:d.name}),children:(l=d.subCategories)!=null&&l.length?[...d.subCategories.map(o),{id:`viewAll-${d._id}`,name:e.jsx("div",{className:"text-base font-bold text-plain-foreground/50",children:"Ver todo"}),onClick:()=>{n(`/pedir/categoria/${d._id}`),a(!1)}}]:null,onClick:(m=d.subCategories)!=null&&m.length?null:()=>{n(`/pedir/categoria/${d._id}`),a(!1)}}};return t==null?void 0:t.map(o)},[t]);return e.jsxs("div",{id:"orderNavigationBar",className:"bg-navbar text-navbar-foreground border-b truncate max-w-full",children:[e.jsx(D,{force:"drawer",open:i,onOpenChange:a,children:e.jsx("div",{className:"max-w-7xl w-full mx-auto py-5",children:e.jsx(er,{data:u})})}),e.jsxs(S,{className:"flex items-center space-x-3 overflow-auto",children:[e.jsx(pe,{variant:"full"}),e.jsxs(O,{"aria-label":"Ver categorías",variant:"outline",onClick:()=>a(!i),children:[e.jsx("div",{className:"font-bold mr-2 hidden md:block",children:"Categorías"}),e.jsx(rr,{className:"w-5 h-5"})]})]})]})}function Qr(){const r=T(),s=C(n=>n==null?void 0:n.setCartOpen),t=x(n=>{var i,a;return((a=(i=n==null?void 0:n.cart)==null?void 0:i.items)==null?void 0:a.length)>0});return e.jsx("div",{id:"orderBar",className:N("dark:bg-muted dark:text-plain-foreground bg-order-bar text-order-bar-foreground py-1.5",{"md:hidden":r==="withCart"}),children:e.jsxs(S,{className:"flex items-center",children:[e.jsxs("div",{className:"flex-1 space-x-4 md:justify-normal flex overflow-hidden",children:[e.jsx(me,{variant:"bar"}),e.jsx(ce,{variant:"bar"})]}),e.jsxs(O,{onClick:()=>s(!0),variant:t?"default":"outline",className:"hidden md:flex text-base items-center space-x-2",children:[e.jsx("div",{children:e.jsx(Pe,{})}),e.jsx(be,{className:"w-5"})]})]})})}function Gr(){const r=qe(),{websitePage:s}=r||{},{pathname:t}=Ne(),n=!t.startsWith("/pedir/categ");return e.jsx(vr,{onNotFound:"hide",path:n?null:t,websitePage:n?s:null})}var Kr=Fe,ne=Ee;function Xr(r,s,t,n){return r==null?[]:(ne(s)||(s=s==null?[]:[s]),t=n?void 0:t,ne(t)||(t=t==null?[]:[t]),Kr(r,s,t))}var Zr=Xr;const es=Te(Zr);function Ae(){const r=W();return e.jsx("div",{className:N("space-y-8 orderProductsContainer",{"lg:col-span-2":r.orderLayout==="withCart"}),children:ie(2).map(s=>e.jsxs("div",{className:"space-y-5",children:[e.jsx(A,{size:"h3",children:e.jsx(q,{className:"w-[150px] h-8"})}),e.jsx("div",{className:N("grid gap-5",{"grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6":r.isCompact&&r.isFullWidth,"grid-cols-1 sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-3":!r.isCompact&&r.isFullWidth,"grid-cols-2 sm:grid-cols-2 md:grid-cols-2 lg:grid-cols-4":r.isCompact&&!r.isFullWidth,"grid-cols-1 sm:grid-cols-2 md:grid-cols-2 lg:grid-cols-2":!r.isCompact&&!r.isFullWidth}),children:ie(6).map(t=>e.jsx(q,{className:N("rounded-lg border",{"h-40 items-stretch flex-row":r.isHorizontal&&!r.isHorizontallyReversed,"h-40 items-stretch flex-row-reverse":r.isHorizontallyReversed,"flex-col h-72 items-center":r.isVertical&&!r.isCompact,"flex-col h-[278px] items-center":r.isVertical&&r.isCompact})},t))})]},s))})}function rs(r){const s=P(r,"brand.menuImage.url"),t=P(r,"brand.name"),n=P(r,"lastBrandId"),i=P(r,"brand"),a=`Banner ${t}`,u=P(r,"brand.link");if(!s)return null;const o=!i&&n?e.jsx("div",{className:"h-px bg-gray-200 my-5"}):null;return u?e.jsxs(e.Fragment,{children:[e.jsx("a",{href:u,target:"_blank",rel:"noreferrer",children:e.jsx("div",{className:"w-full relative brand-banner-image",children:e.jsx("img",{alt:a,src:s})})}),o]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-full relative",children:e.jsx("img",{alt:a,src:s})}),o]})}function ss(){const r=C(t=>{var n;return(n=t==null?void 0:t.productsData)==null?void 0:n.debouncedSearchFilter}),s=T();return e.jsx("div",{className:N("text-center text-muted-foreground text-lg py-6 orderProductsContainer",{"lg:col-span-2":s==="withCart"}),children:r?"No se encontraron productos que coincidan con tu búsqueda":"No hay productos en el menú"})}function ts(r){return e.jsx("div",{className:"relative product-card",children:e.jsxs(I,{prefetch:"viewport",preventScrollReset:!0,to:r.to,className:N("rounded-lg flex border bg-card text-card-foreground justify-center","flex-col h-[278px] items-center","p-5 space-y-5 text-muted-foreground"),children:[e.jsx(Ze,{strokeWidth:1,className:"w-10 h-10"}),e.jsx("div",{className:"font-bold",children:"Ver más"})]})})}const is=h.memo(function(s){const t=_(),{categories:n,design:i,isSearch:a}=s,u=T(),o=ue(),d=W("vertical-compact-fast"),l=t.isMultiBrand;let m=null;const c=f=>{var y;let g=null;f.brand&&((y=f.brand)==null?void 0:y._id)!==m&&(g=f.brand,m=g==null?void 0:g._id);const j=g?e.jsx(rs,{brand:g,lastBrandId:m},g._id):null;return!f.brand&&m&&(m=null),j},p=(f,g)=>g?es(f,{price:y=>{var w;return(w=y==null?void 0:y.availabilityAt)==null?void 0:w.finalPrice},name:"name"}[g.type],[g.order]):f,v=f=>t.hideNotAvailableProducts?f.products.some(g=>!g.isOutOfStock):!0;return e.jsx("div",{className:N("space-y-8 orderProductsContainer",{"lg:col-span-2":i.orderLayout==="withCart"}),children:n.filter(v).map(f=>{const g=c(f),j=u==="categories"&&o!==f._id&&!a,y=p(f.products,f.sorting);return e.jsxs("div",{id:`cat-${f._id}`,className:"space-y-5 categoryContainer",children:[l&&e.jsx(e.Fragment,{children:g}),j?e.jsxs(e.Fragment,{children:[e.jsxs(I,{prefetch:"intent",className:"flex items-center",to:`/pedir/categoria/${f._id}`,children:[e.jsx(A,{size:"h3",className:"categoryTitle",children:f.name}),e.jsxs(O,{variant:"link",children:["Ver más ",e.jsx(Or,{className:"w-4 h-4 ml-2"})]})]}),f.description]}):e.jsxs(e.Fragment,{children:[e.jsx(A,{size:"h3",className:"categoryTitle",children:f.name}),f.description]}),e.jsxs("div",{className:N(j?{"flex flex-nowrap space-x-5 [&>*]:w-[160px] [&>*]:flex-shrink-0":!0,"overflow-x-auto scroll-smooth":!0}:{"grid gap-5":!0,"grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6":i.isCompact&&i.isFullWidth,"grid-cols-1 sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-3":!i.isCompact&&i.isFullWidth,"grid-cols-2 sm:grid-cols-2 md:grid-cols-2 lg:grid-cols-4":i.isCompact&&!i.isFullWidth,"grid-cols-1 sm:grid-cols-2 md:grid-cols-1 lg:grid-cols-2":!i.isCompact&&!i.isFullWidth}),children:[y.filter(w=>!t.hideNotAvailableProducts||!w.isOutOfStock).map(w=>e.jsx(ge,{basePath:o?`/pedir/categoria/${o}/p`:null,product:w,design:j?d:i},w._id)),j&&e.jsx(ts,{to:`/pedir/categoria/${f._id}`})]})]},f._id)})})});function as(){const r=W(),s=C(i=>{var a;return(a=i==null?void 0:i.productsData)==null?void 0:a.categories}),t=C(i=>{var a;return(a=i==null?void 0:i.productsData)==null?void 0:a.searchLoading}),n=C(i=>{var a;return(a=i==null?void 0:i.productsData)==null?void 0:a.isSearch});return t?e.jsx(Ae,{}):s!=null&&s.length?e.jsx(is,{categories:s,design:r,isSearch:n}):e.jsx(ss,{})}function ns(){const r=_(),{showAddressModalOnMount:s,showTimeModalOnMount:t}=r.menuConfiguration,n=x(f=>!!f.preferences),[i,a]=se("order.didPromptAddress",!1),[u,o]=se("order.didPromptTime",!1),d=x(f=>f.choosePlaceOpen),l=x(f=>f.setChoosePlaceOpen),m=x(f=>f.chooseTimeOpen),c=x(f=>f.setChooseTimeOpen),p=br(),v=x(f=>{var g;return!!((g=f.preferences)!=null&&g.store)});return h.useEffect(()=>{if(p&&n){if(s&&!d){if(!i&&v){a(!0);return}if(!i){l(!0),a(!0);return}}if(t&&!m&&!d){if(!v||s&&(d||!i))return;if(!u){c(!0),o(!0);return}}}},[d,m,n,p,v,i,u]),null}function os(){var a,u;const r=x(o=>o==null?void 0:o.preferences),s=_(),t=(a=r==null?void 0:r.store)==null?void 0:a.name,n=(u=r==null?void 0:r.store)==null?void 0:u.streetAddress;return!(s==null?void 0:s.showStoreName)||!t?null:e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(Cr,{children:[e.jsx(yr,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Le,{size:18})," ",t]})}),e.jsx(Nr,{children:e.jsx("div",{children:n})})]})})}function ds(){const r=we(),s=K();return e.jsxs("div",{className:"hidden md:block space-y-5",children:[e.jsx(ke,{}),e.jsx(U,{className:"sticky p-5",style:{top:r+s+20},children:e.jsx(Se,{})})]})}function ls(r){const s=T(),t=!!Y(),n=ye(),[i,a]=h.useState(t),u=C(b=>b==null?void 0:b.cartOpen),o=C(b=>b==null?void 0:b.setCartOpen),d=C(b=>{var X;return!((X=b==null?void 0:b.productsData)!=null&&X.categoriesMap)}),l=C(b=>!!b),m=K(),c=x(b=>b.preferences),p=Oe(),v=!!Y(),{pathname:f}=Ne(),g=f.startsWith("/pedir/categ")||f==="/pedir",j=!v||p||g,w=J().showOrderComponentsInNavbar;return h.useEffect(()=>{t&&a(!0),!t&&i&&a(!1)},[t]),He(b=>{c&&b.orderStarted(c)},[!!c]),e.jsxs("div",{children:[!w&&e.jsxs("div",{className:"sticky z-10 orderStickyHeader",style:{top:m},children:[e.jsx(Qr,{}),s==="categories"?e.jsx(Jr,{}):e.jsx(Yr,{})]}),j&&e.jsx(Gr,{}),j&&e.jsx(oe,{children:e.jsx(ns,{})}),e.jsx($r,{}),e.jsxs(S,{children:[e.jsxs("div",{className:"space-y-5 py-5",children:[e.jsx(os,{}),e.jsx(_r,{}),e.jsxs("div",{className:N({"lg:grid md:grid-cols-2 lg:grid-cols-3 gap-5":s==="withCart"}),children:[e.jsx(Wr,{orderLayout:s}),d||!l?e.jsx(Ae,{}):e.jsx(as,{}),s==="withCart"&&e.jsx(ds,{})]}),e.jsx(Rr,{})]}),e.jsx(D,{open:u,onOpenChange:o,preferSheet:!0,children:e.jsx(Se,{})})]}),g?r.children:e.jsx(D,{includeCloseButtonInDrawer:!0,noPadding:!0,size:"7xl",open:r.children&&i,onOpenChange:b=>{b||(a(!1),setTimeout(()=>{n("/pedir",{preventScrollReset:!0})},300))},children:r.children})]})}function cs(r){return e.jsx(S,{className:"py-5 space-y-5",children:r.children})}const pi=()=>!1,fi=Me(()=>({subtitle:"Pide"}));function us({menuData:r,children:s}){const t=We(r);return e.jsx(Re.Provider,{value:t,children:s})}function hi(){const r=Ye("pages/Order/Layout/index"),{menuData:s}=r,t=Oe(),n=!!Y(),{categoryId:i}=jr(),u=!n||t||i?e.jsx(ls,{children:e.jsx(Z,{children:e.jsx(te,{})})}):e.jsx(cs,{children:e.jsx(Z,{children:e.jsx(te,{})})});return e.jsx("div",{children:e.jsx(h.Suspense,{fallback:u,children:e.jsx(Je,{resolve:s,children:o=>e.jsx(us,{menuData:o,children:u})})})})}export{hi as default,fi as meta,pi as shouldRevalidate};
