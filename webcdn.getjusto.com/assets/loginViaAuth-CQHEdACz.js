import{g as f}from"./jsx-runtime-BGxL3LVy.js";import{d as l,e as g,f as h,i as w,h as y,j as b,k as j,u as $,l as A,g as E,o as L}from"./index-Dg1ijqza.js";import{a as W}from"./apollo-hooks.es-DZ97-Of4.js";import{a as I}from"./useWebsite-B2NA3eOh.js";import{u as C}from"./Context-BxTGfssI.js";import{j as T}from"./env-D6s-xqZ4.js";import{a as m,u as _}from"./index-CXeFjl5i.js";var k=l,P=W,U=g,O=h,R=w,S=y,x=b,H=j,B="[object Map]",v="[object Set]",D=Object.prototype,K=D.hasOwnProperty;function z(t){if(t==null)return!0;if(R(t)&&(O(t)||typeof t=="string"||typeof t.splice=="function"||S(t)||H(t)||U(t)))return!t.length;var o=P(t);if(o==B||o==v)return!t.size;if(x(t))return!k(t).length;for(var e in t)if(K.call(t,e))return!1;return!0}var F=z;const M=f(F),N=(t,o,e)=>{var n;const r={local:"http://auth.internal:5140",dev:"https://auth.bejusto.com",prod:"https://auth.getjusto.com"}[T],a=encodeURIComponent((n=window==null?void 0:window.location)==null?void 0:n.host),s=encodeURIComponent;return`${r}/${t}?${Object.entries({domain:a,return:o,fallback:e}).map(([i,d])=>d?`${s(i)}=${s(d)}`:null).filter(Boolean).join("&")}`},V=(t,o,e,r)=>{const a=window.screenLeft??window.screenX,s=window.screenTop??window.screenY,c=window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width,p=window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height,n=c/window.screen.availWidth,i=(c-e)/2/n+a,d=(p-r)/2/n+s,u=window.open(t,o,`
    scrollbars=yes,
    width=${e/n}, 
    height=${r/n}, 
    top=${d}, 
    left=${i}
    `);return window.focus&&u.focus(),u};function tt(){const t=I(),o=m().pathname,e=C(),r=$(),a=_(),{pathname:s}=m();return()=>{if(r.loginWithExternalProvider){a(`/auth/login-external-provider?return=${encodeURIComponent(s)}`);return}if(r.customLogin==="pide"){A();return}e==null||e.loginStarted();const c=N(t,`/auth/token/ready?return=${encodeURIComponent(o)}`),p=V(c,"Login",350,450),n=setInterval(async()=>{if(p.closed){clearInterval(n);const i=E();M(i)||(e==null||e.loginCompleted(i),L())}},50)}}export{tt as u};
