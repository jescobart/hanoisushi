import{r as l,g as N,j as f}from"./jsx-runtime-BGxL3LVy.js";import{u as M,a as O,f as U,g as P}from"./useWebsite-B2NA3eOh.js";import{a as m}from"./index-DUyAALTD.js";import{b as B}from"./Context-BxTGfssI.js";import{W as D,d as G,l as R,m as A,_ as L,n as z}from"./apollo-hooks.es-DZ97-Of4.js";import{d as q}from"./dayjs.min-C_B9Zj0p.js";import{i as K}from"./env-D6s-xqZ4.js";import{g as j}from"./gql-CqV_3job.js";import{c as H,a as W,y as w,f as I,i as S,z as Y,A as Z}from"./index-Dg1ijqza.js";import{a as v,u as X}from"./useDebouncedValue-HavTh-j-.js";import{a as J,u as Q}from"./useActiveCategory-BOgNxwo5.js";import{_ as $}from"./isEqual-iux_d1W7.js";import{r as V}from"./get---A8iXU-.js";import{e as ee,c as re}from"./index-Dz7ujoPl.js";import{i as k}from"./identity-CwXImgea.js";import{i as te}from"./tslib.es6-B4nGuNfR.js";import{_ as ne}from"./_isIterateeCall-2n3a4jSQ.js";import{a as se,b as ae,c as oe}from"./tooltip-saQE01Fr.js";import{c as ie}from"./utils-mMyIM9tf.js";function ue(){const e=m(n=>{var s,i;return(i=(s=n.preferences)==null?void 0:s.store)==null?void 0:i._id}),r=m(n=>{var s;return(s=n.preferences)==null?void 0:s.deliverAt}),{data:t,loading:a}=D({clientName:H.main,query:j(`query getOutOfStockItemsAtStore($storeId: ID) {
      outOfStockItems(storeId: $storeId) {
        _id
        untilDate
        productId
        modifierOptionId
        stock
      }
    }`),variables:{storeId:e},skip:!e||K}),o=l.useMemo(()=>((t==null?void 0:t.outOfStockItems)||[]).filter(n=>!r||!n.untilDate?!0:!q(r).isAfter(n.untilDate)).reduce((n,s)=>(n[s.productId||s.modifierOptionId]=s.stock||0,n),{}),[t==null?void 0:t.outOfStockItems,r]);return{outOfStockItems:t==null?void 0:t.outOfStockItems,outOfStockItemsMap:o,outOfStockItemsLoading:a}}function ce(e,r,t){return l.useMemo(()=>t?(t==null?void 0:t.map(a=>{const o=r[a];return o?{...r[a],products:o.productIds.map(n=>e[n]).filter(Boolean)}:null}).filter(Boolean))||[]:null,[e,r,t])}function fe(){var r;const e=M();return(r=e.menuConfiguration)!=null&&r.showMenuByCategories?"categories":e.menuLayout==="v1"?"withCart":"fullWidth"}function le(e){const{menuId:r,isDefaultMenu:t}=e,a=O(),o=fe(),n=J(),s=Q(),i=v(`/v1/websites/${a}/menus/${r}${o==="categories"?"/categories":""}`,{skip:e.menuData?t:!0}),u=v(`/v1/websites/${a}/menus/${r}/categories/${s}`,{skip:e.menuData&&s?n&&t:!0}),c=l.useMemo(()=>e.menuData?t?e.menuData:i.data||e.menuData:null,[r,i.loading]);return l.useMemo(()=>c?s?t&&n?h(n,c):u.data?h(u.data,c):n?h(n,c):null:c:null,[c,s,u.loading])}function h(e,r){var t,a,o,n;return e!=null&&e.category?{categoryTree:r.categoryTree,menu:{_id:`category:${e.category._id}`,categoryIds:[...e.category.subcategoryIds,e.category._id]},products:e.products,categories:{[((t=e.category.parentCategory)==null?void 0:t._id)||"nil"]:{_id:((a=e.category.parentCategory)==null?void 0:a._id)||"nil",index:0,image:((o=e.category)==null?void 0:o.image)||null,menuId:`category:${e.category._id}`,name:((n=e.category.parentCategory)==null?void 0:n.name)||"nil",subcategoryIds:[e.category._id],productIds:[],websiteId:e.category.websiteId,parentCategory:null},...e.subCategories,[e.category._id]:e.category}}:null}function de(e,r){const t=m(a=>{var o,n;return(n=(o=a.preferences)==null?void 0:o.store)==null?void 0:n._id});return l.useMemo(()=>{const a=Object.values(e||{});return Object.fromEntries(a.map(o=>{var n;return[o._id,{...o,isOutOfStock:r[o._id]===0,modifiers:(n=o.modifiers)==null?void 0:n.map(s=>{var i;return{...s,options:(i=s.options)==null?void 0:i.map(u=>({...u,isOutOfStock:r[u._id]===0}))}})}]}))},[t,r,e])}function pe(e){return e?e.normalize("NFD").replace(/[\u0300-\u036f]/g,"").trim().toLowerCase():""}function Mt(e){return e?e.normalize("NFD").replace(/[\u0300-\u036f]/g,"").trim().replace(/\s/g,"").toLowerCase():""}function me(e){const{menuId:r,isDefaultMenu:t}=e,a=t?"default":r,o=O(),[n,s]=X(pe(e.searchFilter),200),i=`/v1/websites/${o}/menus/${a}/search?query=${encodeURIComponent(n)}`,u=v(i,{skip:!n});return l.useMemo(()=>{if(!e.searchFilter)return{searchLoading:!1};const c=u.data;return c?{searchLoading:u.loading||s,debouncedSearchFilter:n,searchMenuData:{categoryTree:e.menuData.categoryTree,menu:{_id:`search:${n}`,categoryIds:c.categoryIds},products:c.products,categories:c.categories}}:{searchLoading:!0}},[u.loading,n,e.searchFilter,s])}function be(e){var c;const{outOfStockItemsMap:r}=e,t=le(e),{searchLoading:a,debouncedSearchFilter:o,searchMenuData:n}=me(e),s=n||t,i=de(s==null?void 0:s.products,r),u=ce(i,s==null?void 0:s.categories,(c=s==null?void 0:s.menu)==null?void 0:c.categoryIds);return l.useMemo(()=>({isSearch:!!n,categories:u,productsMap:i,categoriesMap:s==null?void 0:s.categories,debouncedSearchFilter:o,searchLoading:a,categoriesTree:(s==null?void 0:s.categoryTree)||[]}),[u,n,s,i,o,a])}function Ot(e){const r=M(),{searchFilter:t,setSearchFilter:a,cartOpen:o,setCartOpen:n}=B(g=>g),i=m(g=>{var E;return(E=g.preferences)==null?void 0:E.menuId})||r.defaultMenuId,u=i===r.defaultMenuId,c=ue(),d=r.defaultMenuId,p=be({searchFilter:t,menuData:e,outOfStockItemsMap:c.outOfStockItemsMap,menuId:i,isDefaultMenu:u}),C={loaded:!0,cartOpen:o,setCartOpen:n,menuData:e,menuId:i,isDefaultMenu:u,defaultMenuId:d,searchFilter:t,setSearchFilter:a,productsData:p,...c};return l.useMemo(()=>C,Object.values(C))}const ge=U(null);function Rt(e){return P(ge,e)}var he=G,_e=$,ve=1,Ce=2;function Ee(e,r,t,a){var o=t.length,n=o,s=!a;if(e==null)return!n;for(e=Object(e);o--;){var i=t[o];if(s&&i[2]?i[1]!==e[i[0]]:!(i[0]in e))return!1}for(;++o<n;){i=t[o];var u=i[0],c=e[u],d=i[1];if(s&&i[2]){if(c===void 0&&!(u in e))return!1}else{var p=new he;if(a)var b=a(c,d,u,e,r,p);if(!(b===void 0?_e(d,c,ve|Ce,a,p):b))return!1}}return!0}var ye=Ee,Fe=W;function Me(e){return e===e&&!Fe(e)}var x=Me,Oe=x,Re=w;function Ae(e){for(var r=Re(e),t=r.length;t--;){var a=r[t],o=e[a];r[t]=[a,o,Oe(o)]}return r}var Le=Ae;function we(e,r){return function(t){return t==null?!1:t[e]===r&&(r!==void 0||e in Object(t))}}var T=we,Ie=ye,Se=Le,$e=T;function ke(e){var r=Se(e);return r.length==1&&r[0][2]?$e(r[0][0],r[0][1]):function(t){return t===e||Ie(t,e,r)}}var xe=ke;function Te(e,r){return e!=null&&r in Object(e)}var Ne=Te,Ue=Ne,Pe=ee;function Be(e,r){return e!=null&&Pe(e,r,Ue)}var De=Be,Ge=$,ze=V(),qe=De,Ke=R,je=x,He=T,We=A,Ye=1,Ze=2;function Xe(e,r){return Ke(e)&&je(r)?He(We(e),r):function(t){var a=ze(t,e);return a===void 0&&a===r?qe(t,e):Ge(r,a,Ye|Ze)}}var Je=Xe;function Qe(e){return function(r){return r==null?void 0:r[e]}}var Ve=Qe,er=L;function rr(e){return function(r){return er(r,e)}}var tr=rr,nr=Ve,sr=tr,ar=R,or=A;function ir(e){return ar(e)?nr(or(e)):sr(e)}var ur=ir,cr=xe,fr=Je,lr=k,dr=I,pr=ur;function mr(e){return typeof e=="function"?e:e==null?lr:typeof e=="object"?dr(e)?fr(e[0],e[1]):cr(e):pr(e)}var br=mr;function gr(e){return function(r,t,a){for(var o=-1,n=Object(r),s=a(r),i=s.length;i--;){var u=s[e?i:++o];if(t(n[u],u,n)===!1)break}return r}}var hr=gr,_r=hr,vr=_r(),Cr=vr,Er=Cr,yr=w;function Fr(e,r){return e&&Er(e,r,yr)}var Mr=Fr,Or=S;function Rr(e,r){return function(t,a){if(t==null)return t;if(!Or(t))return e(t,a);for(var o=t.length,n=r?o:-1,s=Object(t);(r?n--:++n<o)&&a(s[n],n,s)!==!1;);return t}}var Ar=Rr,Lr=Mr,wr=Ar,Ir=wr(Lr),Sr=Ir,$r=Sr,kr=S;function xr(e,r){var t=-1,a=kr(e)?Array(e.length):[];return $r(e,function(o,n,s){a[++t]=r(o,n,s)}),a}var Tr=xr;function Nr(e,r){var t=e.length;for(e.sort(r);t--;)e[t]=e[t].value;return e}var Ur=Nr,y=te;function Pr(e,r){if(e!==r){var t=e!==void 0,a=e===null,o=e===e,n=y(e),s=r!==void 0,i=r===null,u=r===r,c=y(r);if(!i&&!c&&!n&&e>r||n&&s&&u&&!i&&!c||a&&s&&u||!t&&u||!o)return 1;if(!a&&!n&&!c&&e<r||c&&t&&o&&!a&&!n||i&&t&&o||!s&&o||!u)return-1}return 0}var Br=Pr,Dr=Br;function Gr(e,r,t){for(var a=-1,o=e.criteria,n=r.criteria,s=o.length,i=t.length;++a<s;){var u=Dr(o[a],n[a]);if(u){if(a>=i)return u;var c=t[a];return u*(c=="desc"?-1:1)}}return e.index-r.index}var zr=Gr,_=Y,qr=L,Kr=br,jr=Tr,Hr=Ur,Wr=Z,Yr=zr,Zr=k,Xr=I;function Jr(e,r,t){r.length?r=_(r,function(n){return Xr(n)?function(s){return qr(s,n.length===1?n[0]:n)}:n}):r=[Zr];var a=-1;r=_(r,Wr(Kr));var o=jr(e,function(n,s,i){var u=_(r,function(c){return c(n)});return{criteria:u,index:++a,value:n}});return Hr(o,function(n,s){return Yr(n,s,t)})}var Qr=Jr,Vr=z,et=Qr,rt=re,F=ne,tt=rt(function(e,r){if(e==null)return[];var t=r.length;return t>1&&F(e,r[0],r[1])?r=[]:t>2&&F(r[0],r[1],r[2])&&(r=[r[0]]),et(e,Vr(r,1),[])}),nt=tt;const At=N(nt);function Lt(e,r){const t={};for(const a of e){const o=typeof r=="function"?r(a):String(a[r]);t[o]=a}return t}const st={VEGAN:{URL:"https://s3.amazonaws.com/orion-eat-app-files/buckets-prod%2FYNHhFnJ49oaeNo4bh-VEGAN.svg",label:"Vegano"},VEGETARIAN:{URL:"https://s3.amazonaws.com/orion-eat-app-files/buckets-prod%2FTtMZJWqFeoM6jXZPT-VEGETARIAN.svg",label:"Vegetariano"},CACAO_100:{URL:"https://s3.amazonaws.com/orion-eat-app-files/buckets-prod%2FvyL8X6C4BMa3GmGPB-COCOA_100.svg",label:"100% cacao"},GLUTEN_FREE:{URL:"https://s3.amazonaws.com/orion-eat-app-files/buckets-prod%2FpAkb6dT9J5BCNdw9b-GLUTEN_FREE.svg",label:"Sin gluten"},LACTOSE_FREE:{URL:"https://s3.amazonaws.com/orion-eat-app-files/buckets-prod%2FXN85u2RmNmZzZbXwm-LACTOSE_FREE.svg",label:"Sin lactosa"},SUGAR_FREE:{URL:"https://s3.amazonaws.com/orion-eat-app-files/buckets-prod%2F9tFGhk4Yeo7CGrb4p-SUGAR_FREE.svg",label:"Sin azÃºcar"},RECYCLABLE:{URL:"https://s3.amazonaws.com/orion-eat-app-files/buckets-prod%2FuytNnxyQ8HnKkJgqe-RECYCLABLE.svg",label:"Reciclable"},SPICY:{URL:"https://s3.amazonaws.com/orion-eat-app-files/buckets-prod%2FRo6uAC2RWMGg3Tqa7-SPICY.svg",label:"Picante"},RECYCLED:{URL:"https://s3.amazonaws.com/orion-eat-app-files/buckets-prod%2Ft2xxZt5dqeK5JxWSx-RECICLED.svg",label:"Reciclado"},HANDMADE:{URL:"https://s3.amazonaws.com/orion-eat-app-files/buckets-prod%2FDCynECNEfDyMFAaed-HANDMADE.svg",label:"Hecho a mano"},OLDER_THAN_18:{URL:"https://s3.amazonaws.com/orion-eat-app-files/buckets-prod%2FKKF3DBuShnTzrNrLz-OLDER_THAN_18.svg",label:"Mayor de 18"},CRUELTY_FREE:{URL:"https://s3.amazonaws.com/orion-eat-app-files/buckets-prod%2FyNBMHBvXPe5gjraTt-CRUELTY_FREE.svg",label:"No testeado en animales"},KETO:{URL:"https://s3.amazonaws.com/orion-eat-app-files/buckets-prod%2Fv99t5FTchxQkpjgY3-KETO.svg",label:"Keto"},REFRIGERATED:{URL:"https://tofuu.getjusto.com/buckets-prod%2FXgZzDqmkS6C2Mq48m-refrigerator-svgrepo-com.svg",label:"Refrigerado"},FROZEN:{URL:"https://tofuu.getjusto.com/buckets-prod%2FeELGs3SffyDp7bfs6-ice-svgrepo-com.svg",label:"Congelado"}};function wt({stamps:e,iconOnly:r}){if(!(e!=null&&e.length))return null;const t=e.map((a,o)=>{const n=st[a];return n?r?f.jsx("div",{className:"flex flex-row p-0.5 items-center",children:f.jsxs(se,{children:[f.jsx(ae,{children:f.jsx("div",{className:"flex items-center",children:f.jsx("img",{className:"dark:brightness-[5]",alt:n.label,src:n.URL,width:"16",height:"16"})})}),f.jsx(oe,{children:f.jsx("p",{children:n.label})})]})},o):f.jsxs("div",{className:"flex flex-row rounded-3xl gap-x-1 px-2 py-0.5 items-center whitespace-nowrap",children:[f.jsx("img",{className:"inline-block dark:brightness-[4] h-4 w-4",alt:n.label,src:n.URL,width:"16",height:"16"},o),f.jsx("div",{className:"inline-block text-sm align-text-top",children:n.label})]},o):null});return f.jsx("div",{className:ie("flex flex-row flex-wrap justify-start",{"flex-none":r,"gap-y-2 gap-x-3 px-5":!r}),children:t})}export{wt as I,ge as O,Sr as _,fe as a,br as b,Lt as c,Qr as d,Ot as e,Mt as n,At as s,Rt as u};
